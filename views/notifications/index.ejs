<%- include('../partials/header') %>

<div class="container" style="padding: 30px 20px; min-height: 60vh;">
    <div class="section-header">
        <h3 class="section-title">Notifications</h3>
        <% if (notifications.some(n => !n.read)) { %>
            <form action="/notifications/mark-all-read" method="POST">
                <button type="submit" class="slide-btn" style="font-size: 12px; padding: 6px 12px;">Mark all as read</button>
            </form>
        <% } %>
    </div>

    <% if (notifications.length === 0) { %>
        <div style="text-align: center; padding: 60px 20px; background: white; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
            <div style="font-size: 48px; color: var(--text-muted); margin-bottom: 20px;">
                <i class="far fa-bell-slash"></i>
            </div>
            <h3 style="color: var(--secondary);">No Notifications</h3>
            <p style="color: var(--text-muted); max-width: 400px; margin: 0 auto;">You're all caught up!</p>
        </div>
    <% } else { %>
        <div style="display: flex; flex-direction: column; gap: 15px;">
            <% notifications.forEach(notification => { %>
                <div style="background: <%= notification.read ? 'white' : '#f0f9ff' %>; padding: 20px; border-radius: var(--radius-md); box-shadow: var(--shadow-sm); border-left: 5px solid <%= notification.read ? '#ddd' : 'var(--primary)' %>; display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                            <% if (notification.type === 'order_update') { %>
                                <span style="color: var(--primary);"><i class="fas fa-box"></i> Order Update</span>
                            <% } else if (notification.type === 'service_update') { %>
                                <span style="color: #9c27b0;"><i class="fas fa-tools"></i> Service Update</span>
                            <% } else { %>
                                <span style="color: var(--secondary);"><i class="fas fa-info-circle"></i> Info</span>
                            <% } %>
                            <span style="font-size: 12px; color: var(--text-muted);">â€¢ <%= new Date(notification.createdAt).toLocaleString() %></span>
                        </div>
                        <p style="margin: 0; color: var(--text-main);"><%= notification.message %></p>
                        <% if (notification.relatedId) { %>
                            <a href="/orders" style="font-size: 12px; color: var(--primary); text-decoration: underline; margin-top: 8px; display: inline-block;">View Order</a>
                        <% } %>
                    </div>
                    
                    <% if (!notification.read) { %>
                        <form action="/notifications/mark-read/<%= notification._id %>" method="POST">
                            <button type="submit" title="Mark as read" style="background: none; border: none; color: var(--text-muted); cursor: pointer;">
                                <i class="fas fa-check"></i>
                            </button>
                        </form>
                    <% } %>
                </div>
            <% }) %>
        </div>
    <% } %>
</div>

<%- include('../partials/footer') %>
