✦ I have successfully created the login and signup pages, ensuring they are
  responsive, accessible, and visually consistent with your existing design.

  Here is a summary of the changes:
   1. Created `public/css/auth.css`: A dedicated stylesheet for authentication
      pages that uses your existing color palette and variables (e.g., --primary,
      --radius-md) to ensure a cohesive look. It features a centered card layout
      that adapts to different screen sizes.
   2. Created `views/login.ejs`: A clean, user-friendly login form including
      "Remember me" and "Forgot Password" options.
   3. Created `views/signup.ejs`: A registration form with validation attributes
      (e.g., required, minlength) for better accessibility and user feedback.
   4. Updated `views/partials/header.ejs`: Modified the header to accept an
      optional extraCss variable, allowing the auth pages to load their specific
      styles without bloating the main stylesheet.
   5. Updated Controller & Routes: Added getLoginPage and getSignupPage to
      controllers/home.controller.js and registered the /login and /signup routes
      in routes/home.routes.js.

  You can now access these pages at /login and /signup.

   I've created a dedicated signup page for businesses that captures the necessary
  information as outlined in the context.

  Summary of changes:

   1. User Model (`models/user.js`): Defined the Mongoose schema to include the
      role field (supporting 'consumer', 'sme_owner', etc.) and a phone field,
      which is critical for business accounts.
   2. Business Signup View (`views/signup-business.ejs`): Created a new template
      specifically for SMEs. It features:
       * A distinct "Register Your Business" header.
       * A Phone Number field (essential for SMEs).
       * A hidden input to automatically set the role to sme_owner.
       * Links back to the consumer signup and login pages.
   3. Controller & Routes:
       * Added getBusinessSignupPage to controllers/home.controller.js.
       * Registered the route /business/register in routes/home.routes.js.
   4. Navigation Updates:
       * Updated the "Register Your Business (SME)" link in the top bar of the
         header to point to the new page.
       * Added a cross-link in the standard consumer signup page ("Want to sell on
         CBECS? Register as a Business") to ensure users find the right form.

  You can now access the business registration page at /business/register.


✦ I've finalized the Passport authentication setup.

  Summary of actions:
   1. Dependencies: Installed bcryptjs for secure password hashing.
   2. User Model: Updated models/user.js to include a pre-save hook for password
      hashing and a comparePassword method.
   3. Passport Config: Created config/passport.js implementing the Local Strategy
      for authentication.
   4. Controller: Created controllers/auth.controller.js to handle:
       * Registration: Hashes passwords, validates input, and handles role
         assignment (including defaulting to 'consumer' and accepting 'sme_owner'
         from the business form).
       * Login: Authenticates via Passport and redirects users based on their role
         (e.g., SMEs to /sme/dashboard, Consumers to /).
       * Logout: Ends the session and redirects to login.
   5. Middleware: Created middleware/auth.js with ensureAuthenticated to protect
      routes and forwardAuthenticated to redirect logged-in users away from auth
      pages.
   6. Routes: Updated routes/home.routes.js to bind the POST actions for /login,
      /signup, and /business/register, and added the /logout route.
   7. Views: Updated views/signup.ejs and views/signup-business.ejs to display
      validation errors from the server and preserve input values if registration
      fails.

  You can now:
   * Register as a Consumer at /signup.
   * Register as a Business at /business/register.
   * Login at /login and be redirected to your role-specific dashboard.
   * Access protected dashboard routes (currently placeholders) which verify
     authentication.

     ✦ I have successfully implemented the SME onboarding process.

  Summary of changes:

   1. Models: Created models/business.js to store business profile information
      including owner reference, category, address, description, and logo path.
   2. File Uploads: Installed and configured multer in routes/sme.routes.js to
      handle logo uploads, saving them to public/uploads/logos.
   3. Controller: Created controllers/sme.controller.js to handle:
       * Rendering the "Create Business" form.
       * Processing the form submission, including file handling and database
         saving.
       * Rendering the SME Dashboard with a list of the user's businesses.
   4. Views:
       * Created views/sme/create-business.ejs: A responsive form for business
         details and logo upload.
       * Created views/sme/dashboard.ejs: A dashboard displaying the user's
         businesses or a prompt to create one if none exist.
   5. Routes:
       * Created routes/sme.routes.js to define /create-business and /dashboard
         routes, protected by authentication and role checks (sme_owner).
       * Mounted this new router at /sme in routes/index.routes.js.
       * Cleaned up temporary dashboard placeholders in routes/home.routes.js.

  Next Steps:
  You can now log in as an SME owner (or register one via /business/register) and
  navigate to /sme/dashboard. From there, you can click "Create New Business" to
  onboard a new shop.

  ✦ I have implemented the listings system by creating the necessary EJS views that
  correspond to the existing controller logic and routes.

  Summary of changes:
   1. Created `views/sme/listings/index.ejs`:
       * Displays a grid of the SME's listings.
       * Shows images, prices, and stock/duration details.
       * Includes "Edit" and "Delete" actions for each listing.
   2. Created `views/sme/listings/add.ejs`:
       * Provides a form to add new listings.
       * Includes a dynamic dropdown for selecting the Business.
       * Feature: Automatically toggles between "Stock" (for Retail/Food) and
         "Duration" (for Service) input fields based on the selected business
         category using client-side JavaScript.
   3. Created `views/sme/listings/edit.ejs`:
       * Provides a form to edit existing listings.
       * Pre-fills current data.
       * Shows the appropriate fields (Stock vs Duration) based on the listing's
         type (which is fixed upon creation).

  The system now supports:
   * Viewing all listings at /sme/listings
   * Adding a listing at /sme/listings/add (handling the Product vs Service
     distinction)
   * Editing a listing at /sme/listings/:id/edit
   * Deleting a listing via /sme/listings/:id/delete

  You can now start the server (npm start) and navigate to the SME Dashboard to
  manage listings.


✦ I have implemented the "Manage Business" feature.

  Summary of changes:
   1. Updated `routes/sme.routes.js`:
       * Added GET /sme/business/:id/manage to display the management page.
       * Added POST /sme/business/:id/update to handle business profile updates
         (name, address, description, logo).
       * Added POST /sme/business/:id/delete to handle business deletion.
   2. Updated `controllers/sme.controller.js`:
       * Implemented getManageBusinessPage: Fetches the business data and renders
         the view.
       * Implemented updateBusiness: Updates the business details and handles logo
         uploads.
       * Implemented deleteBusiness: Deletes the business (Note: In a production
         app, this should also recursively delete listings, images, orders, etc.,
         but for now it removes the business document).
   3. Created `views/sme/manage-business.ejs`:
       * Displays the "Business Settings" form.
       * Includes "Quick Actions" links to Add/View listings.
       * Includes placeholders for future "Operators" and "Orders" modules, as per
         the system overview in @robot.md.
       * Includes a "Delete Business" button with confirmation.

  The link in the Dashboard (views/sme/dashboard.ejs) that points to
  /sme/business/<%= biz._id %>/manage will now work correctly.

  ✦ I have implemented the public-facing browsing and searching system.

  Summary of Changes:

   1. Created `controllers/consumer.controller.js`:
       * getAllCategories: Renders the main category selection page.
       * getCategoryListings: Fetches and renders listings filtered by type
         ('retail'/'product', 'service', 'food').
       * getListingDetails: Fetches a specific listing by ID, showing details and
         related items.
       * searchListings: Implements a case-insensitive regex search on listing
         names and descriptions.

   2. Updated `routes/home.routes.js`:
       * Added routes: /categories, /categories/:id, /listing/:id, and /search
         pointing to the new consumer controller.

   3. Created Views:
       * views/categories/index.ejs: A clean grid layout displaying the three main
         business categories.
       * views/categories/show.ejs: Displays a grid of listings for a specific
         category.
       * views/listings/show.ejs: A detailed product/service page with image,
         description, price, stock status, and placeholder "Add to Cart"/"Book Now"
         buttons.
       * views/search.ejs: Displays search results or a "No Results" message.

  You can now browse the platform as a guest, view products, and search for items
  without needing to log in

  ✦ I have implemented the persistent Cart and Checkout system.

  Summary of Changes:

   1. Created `models/order.js`: A schema to store order details (items, total
      amount, status).
   2. Created `controllers/cart.controller.js`:
       * addToCart: Adds items to req.session.cart, handling quantity updates for
         existing items.
       * getCart: Renders the cart view.
       * removeFromCart: Removes items and updates totals.
       * postCheckout: Checks authentication, creates an Order record, clears the
         session cart, and redirects.
   3. Created `routes/cart.routes.js`: Defined routes for /cart (GET), /cart/add
      (POST), /cart/remove/:id (POST), and /checkout (POST, protected).
   4. Updated `routes/index.routes.js`: Mounted the cart routes.
   5. Created `views/cart.ejs`: Displays the cart items, image, price, quantity,
      subtotal, and a checkout button.
   6. Updated `views/listings/show.ejs`: "Add to Cart" and "Book Now" buttons now
      function as forms submitting to /cart/add.
   7. Updated `views/partials/header.ejs`:
       * The Cart icon now shows a dynamic badge count based on the session.
       * Authentication links (Sign In / Logout / Dashboard) are now dynamic based
         on login status.
   8. Updated `app.js`: Added res.locals.cart = req.session.cart so the header can
      access cart data globally.

  The system now supports adding items to the cart as a guest, viewing the cart,
  and requiring login only upon checkout. Checkout creates a persistent order in
  the database.